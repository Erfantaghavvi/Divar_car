import pandas as pd

# بارگذاری فایل بهبود یافته
df = pd.read_excel('improved_divar_ads_20250829_180542.xlsx')

print('🔍 بررسی نهایی بهبودهای اعمال شده:')
print('\n📊 آمار کلی:')
print(f'- تعداد کل رکوردها: {len(df)}')
print(f'- رکوردهای با نام خودرو: {df["نام خودرو"].notna().sum()}')
print(f'- رکوردهای با برند و تیپ: {df["برند و تیپ"].notna().sum()}')
print(f'- رکوردهای با کیلومتر: {df["کیلومتر"].notna().sum()}')

print('\n✅ نمونه‌هایی از بهبودهای اعمال شده:')
sample = df[['عنوان آگهی', 'نام خودرو', 'برند و تیپ', 'کیلومتر']].head(10)
print(sample.to_string(index=False))

print('\n🎯 مقایسه قبل و بعد:')
print('قبل: نام خودرو = عنوان آگهی (اشتباه)')
print('بعد: نام خودرو جدا از عنوان آگهی (صحیح)')
print('\nقبل: برند و تیپ = عنوان آگهی (اشتباه)')
print('بعد: برند و تیپ دقیق‌تر استخراج شده (صحیح)')
print('\nقبل: کیلومتر با CSS selector عمومی')
print('بعد: کیلومتر با CSS selector مشخص شده توسط کاربر')